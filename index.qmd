---
title: "ALS data coverage in Canadian forests"
format: html
engine: knitr
lightbox: true
date: today
language: 
  title-block-published: "Last modified"
---

This webpage is designed to present the current status of airborne laser scanning (ALS) data coverage across **Canada's forested landscapes**. We present a collection of maps and descriptive statistics that illustrate the current status and availability of ALS data, specifically focusing on its applications within forestry. ALS acquisitions outside Canada's forested ecozones (e.g. in urban areas) or data acquired for research projects are not included.

This webpage accompanies the publication by [White et al. 2025](https://doi.org/10.1139/cjfr-2024-0255), and is designed to keep the statistics and maps presented in the paper up to date.

::: {.callout-note appearance="minimal"}

*White, J.C., Tompalski, P., Bater C.W., Wulder, M.A., Fortin, M., Hennigar C., Robere-McGugan, G., Sinclair, I., White, R., (2025). Enhanced forest inventories in Canada: implementation, status, and research needs. Canadian Journal of Forest Research, 55: 1-37. [doi.org/10.1139/cjfr-2024-0255](https://doi.org/10.1139/cjfr-2024-0255). *
:::

Information on this website is periodically updated to ensure the most current and accurate representation of ALS data coverage. See [ALS coverage data sources](data.qmd) to find the date the coverage was updated for each jurisdiction.

# Most recent coverage summary

```{r, echo=F, warning=F, message=F}
source("R/0000_setup.R")
# library(tidyverse);library(magrittr)
Stats <- readRDS("layers/Stats.rds")
theTable <-Stats$theTable

total_ALS_area <- Stats$total_ALS_area
total_ALS_perc <- Stats$total_ALS_perc
managed_ALS_perc  <- round(Stats$managed_ALS_perc,1)
forested_ALS_perc <- round(Stats$forested_ALS_perc,1)

```

```{r, echo=F, warning=F, message=F}
library(htmltools)
library(bslib)
library(bsicons)


vbs <- list(
  value_box(
    title = "Total ALS Coverage",
    value = paste0(format(round(total_ALS_area / 1000000, 2), big.mark=",", nsmall = 0),"M km²"),
    # value = paste0(format(total_ALS_area, big.mark=",", nsmall = 0)," km²"),
    # showcase = bs_icon("graph-up"),
    theme = "primary",
    p(paste0(format(total_ALS_perc, nsmall = 1),"% of total land area of Canada."))
    # p("hit me", bs_icon("suit-spade"))
  ),
  
  
  value_box(
    title = "Coverage of forested ecozones",
    value = paste0(format(forested_ALS_perc, nsmall = 1),"%"),
    theme = "secondary",
    # showcase = bs_icon("graph-up")
  ),
  
  value_box(
    title = "Coverage of managed forests",
    value = paste0(format(managed_ALS_perc, nsmall = 1),"%"),
    # showcase = bs_icon("tree-fill")
    theme = "success",
  )
)
layout_column_wrap(
  width = "200px",
  !!!vbs
)

```

The total area of ALS coverage in Canada is currently `r format(total_ALS_area, scientific=FALSE, big.mark=",")` km^2^, which corresponds to approximately **`r total_ALS_perc`%** of the total land area of the country. The coverage of all forested ecozones is approximately **`r forested_ALS_perc`%**, while the coverage of managed forests is approximately **`r managed_ALS_perc`%**.

```{r, echo=F, warning=F, message=F}
theTable %>%
  #inlcude only ALS coverage columns
  # select(Jurisdiction, `ALS area (total)`, `ALS area (managed forest)`) %>%
  knitr::kable()  
```

# Maps

The map showing the overall ALS coverage is presented below. Additional [maps](maps.qmd) show [**acquisition year**](maps.qmd#maps-year), [**point cloud density**](maps.qmd#maps-density), and [**areas of multiple overlapping acquisitions**](maps.qmd#maps-overlap). More detailed maps are available for [western](maps-west.qmd) and [eastern](maps-east.qmd) parts of the country.

![](img/map0_overview.png){.lightbox}

# Acquisitions over time


```{r, echo=F, warning=F, message=F}
library(ggiraph)
library(ggtext)

prov_clrs <- tribble(
  ~Jurisdiction, ~color,
  "AB", "#1f78b4",
  "BC", "#33a02c",
  
  "NB", "#6a3d9a",
  
  "NS", "#ff7f00",
  
  "ON", "#666666",
  "PE", "#800000",
  "QC", "#b15928",
  "SK", "#c71585"
)

clrs <- prov_clrs$color
names(clrs) <- (prov_clrs$Jurisdiction)

D <- readRDS("layers/dataForTheFigure_v2.rds")
g <- D %>%
  ggplot(aes(
    year,
    Total_ALS_acquisitions_area_cumulative / 1000,
    color = jurisdiction_code,
    group = jurisdiction_code,
    # here we add iteractive aesthetics
    tooltip = tip,
    data_id = jurisdiction_code
  )) +
  # geom_pointpath(mult=0.25, shape=21, size=2)+
  geom_line_interactive(
    aes(tooltip = NULL)
    # hover_css = "stroke:#ff7f0e; stroke-width:3px; fill:none; fill-opacity:0;",
    # selected_css = "stroke:#2E86DE; stroke-width:3.5px; fill:none; fill-opacity:0;"
  ) +
  geom_point_interactive(
    hover_nearest = F,
    size = 6 / .pt,
    hover_css = "r:3px;", selected_css = "r:1px;"
    # hover_css = "r:6px; fill:#ff7f0e; stroke:black; stroke-width:1.5px;",
    # selected_css = "r:7px; fill:#2E86DE; stroke:black; stroke-width:2px;"
  ) +

  # geom_point(data=DF_area_recent_adj, size=2) +
  xlab("Acquisition year") +
  ylab(expression(paste("Area [thousands of km"^2 * "]"))) +
  scale_color_manual(values = clrs, name = "")+
  labs(
    title = "Cumulative area of ALS acquisitions", 
    subtitle = "(Overlapping ALS areas are included in totals.)",
    caption = "P<sub>J</sub> = percentage of jurisdictional area that is covered by ALS data.<br>
    P<sub>M</sub> = percentage of jurisdictional managed forest area that is covered by ALS data.") +
        theme(
    plot.caption = element_markdown(size = 10, colour = "#888888"),
    plot.subtitle = element_markdown(),
    plot.title = element_markdown()
  )


g <- girafe(ggobj = g)

g <- girafe_options(
  g,
  opts_hover(css = "opacity:1;"),            # hovered = full opacity (same color)
  opts_hover_inv(css = "opacity:0.2;"),      # everything else = faded
  opts_selection(css = "opacity:1;"),        # when selected, same color
  opts_selection_inv(css = "opacity:0.2;") ,  # non-selected = faded

  # opts_hover(css = "opacity:1;"), # keep hovered fully visible
  # opts_hover_inv(css = "opacity:0.15;"), # dim everything else
  # opts_selection(
    # type = "single",
    # css = "r:7px; fill:#2E86DE; stroke:black; stroke-width:2.5px;"
  # ),
  opts_tooltip(
    css = "background-color: #333333; 
           color: #ffffff; 
           font-family: 'Roboto';
           font-size: 14px;
           border-radius: 6px;
           padding: 5px 10px;
           border: 1px solid #999999;"
  )
)

g


```

<br>

![](img/animation_ALS_over_time.gif){.lightbox}

